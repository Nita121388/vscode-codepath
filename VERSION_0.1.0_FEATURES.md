# CodePath v0.1.0 新功能说明

## 🎉 版本亮点

CodePath v0.1.0 是一个功能完整的代码执行路径追踪扩展，提供了智能的代码位置追踪、灵活的图表管理和便捷的用户界面。

---

## 🌟 核心新功能

### 1. 智能位置追踪 ⭐⭐⭐⭐⭐

**自动检测代码移动，一键更新位置**

当你重构代码或移动函数时，CodePath 会自动检测位置变化并提示更新：

```
代码移动 → 点击节点 → 自动检测 → 点击 OK → 自动更新 → 预览刷新
```

**技术特性**:
- 🔍 4 层搜索策略（精确 → 邻近 → 全文 → 模糊）
- 🎯 4 级置信度评估（exact, high, medium, low）
- 🔐 SHA-256 代码指纹技术
- ⚡ 即时预览更新

**用户体验**:
```
⚠️ Code location may have changed: Code found at line 124 (moved 2 lines)
[OK] [Dismiss]
```

点击 OK 后，节点位置、行号、代码片段自动更新，预览立即刷新！

---

### 2. 树分叉功能 ⭐⭐⭐⭐

**追踪同一代码的多条执行路径**

为已有父节点的节点添加新父节点时，系统自动创建分叉：

**示例**:
```
原始:
root → child → grandchild

添加新父节点后:
├─ newParent → child(副本) → grandchild  (新分支)
└─ root → child(原节点)                   (原分支)
```

**使用场景**:
- 同一函数的不同调用路径
- 不同条件下的执行场景
- 多种可能的代码流程

**特性**:
- ✅ 自动检测并创建分叉
- ✅ 保留原有关系
- ✅ 子树自动转移
- ✅ 独立管理分支

---

### 3. 节点编辑和验证 ⭐⭐⭐⭐

**实时编辑，自动验证，即时更新**

**编辑流程**:
```
点击节点 → Edit Node → 修改信息 → 保存 → 自动验证 → 预览更新
```

**可编辑内容**:
- 节点名称
- 文件路径
- 行号
- 代码片段
- 描述信息（支持多行）

**自动验证**:
- 保存后自动验证位置
- 验证通过: 清除 ⚠️ 警告
- 验证失败: 更新 ⚠️ 警告
- 预览立即刷新

**描述支持**:
- 多行描述
- 灰色斜体显示
- 不影响节点功能

---

### 4. 文件浏览器集成 ⭐⭐⭐⭐

**直接从文件浏览器管理图表**

**预览功能**:
```
右键 .codepath/*.json → "预览 CodePath" → 自动切换并打开预览
```

**分享功能**:
```
右键 .codepath/*.json → "分享 CodePath" → 文件复制到剪贴板
```

**平台支持**:
- Windows: 复制文件到剪贴板 ✅
- macOS: 复制文件到剪贴板 ✅
- Linux: 复制文件路径 ✅

**使用场景**:
- 快速预览任意图表
- 一键分享到聊天工具
- 直接粘贴到文件夹

---

### 5. 导入自动切换 ⭐⭐⭐

**导入后自动切换和导航**

**工作流程**:
```
导入 .md 文件 → 自动切换 → 打开预览 → 导航到当前节点
```

**自动操作**:
- ✅ 自动切换到新图表
- ✅ 自动打开预览面板
- ✅ 自动导航到当前节点
- ✅ 自动打开对应文件

**优势**:
- 无缝导入体验
- 立即可用
- 上下文自动恢复

---

### 6. 预览面板导出 ⭐⭐⭐

**一键导出当前图表**

**使用方式**:
```
预览面板 → 📤 Export 按钮 → 选择位置 → 生成 Markdown
```

**优势**:
- 更快捷的操作
- 无需打开菜单
- 一键完成导出

---

### 7. 状态栏快捷菜单 ⭐⭐⭐⭐⭐

**点击状态栏，快速访问所有功能**

**显示内容**:
```
$(graph) 图表名称 (节点数)
```

**可用操作**:
- 🆕 新建 CodePath
- 🔄 切换 CodePath
- 📤 导出 CodePath
- 📥 导入 CodePath
- 🗑️ 删除 CodePath
- 🔄 刷新预览
- 🎯 切换节点
- 👁️ 切换视图格式

**优势**:
- 一键访问所有功能
- 无需记忆命令
- 实时显示状态
- 友好的图标和说明

---

### 8. 简化文件名显示 ⭐⭐⭐

**预览中只显示文件名，不显示完整路径**

**修改前**:
```
validateInput (/workspace/src/auth/validator.ts:15)
```

**修改后**:
```
validateInput (validator.ts:15)
```

**优势**:
- 更清晰的显示
- 节省空间
- 易于阅读
- 完整路径仍用于导航

---

### 9. 启动自动加载 ⭐⭐⭐

**打开 VS Code 时自动加载上次使用的图表**

**自动操作**:
- 加载上次使用的图表
- 打开预览面板（如果图表有节点）
- 更新状态栏信息
- 恢复工作上下文

**配置**:
```json
{
  "codepath.autoLoadLastGraph": true
}
```

---

## 📊 功能对比

| 功能 | v0.0.x | v0.1.0 |
|------|--------|--------|
| 基础节点创建 | ✅ | ✅ |
| 智能位置追踪 | ❌ | ✅ |
| 树分叉支持 | ❌ | ✅ |
| 节点编辑 | ❌ | ✅ |
| 自动验证 | ❌ | ✅ |
| 文件浏览器集成 | ❌ | ✅ |
| 导入自动切换 | ❌ | ✅ |
| 预览面板导出 | ❌ | ✅ |
| 状态栏菜单 | 基础 | 完整 |
| 启动自动加载 | ❌ | ✅ |
| 描述支持 | ❌ | ✅ |
| 简化文件名 | ❌ | ✅ |

---

## 🎯 使用场景

### 场景 1: 代码重构
```
1. 重构代码，移动函数位置
2. 点击节点，系统自动检测位置变化
3. 点击 OK，自动更新节点位置
4. 预览立即刷新，继续工作
```

### 场景 2: 多路径追踪
```
1. 创建基础执行路径
2. 为关键节点添加新父节点
3. 系统自动创建分叉
4. 分别追踪不同的执行场景
```

### 场景 3: 团队协作
```
1. 创建代码执行路径
2. 点击预览面板 📤 Export 按钮
3. 分享 Markdown 文件给团队
4. 团队成员导入后自动切换和导航
```

### 场景 4: 快速预览
```
1. 在文件浏览器找到 .codepath/*.json
2. 右键 → "预览 CodePath"
3. 自动切换到该图表
4. 立即查看内容
```

### 场景 5: 一键分享
```
1. 右键 .codepath/*.json → "分享 CodePath"
2. 文件复制到剪贴板
3. 粘贴到微信/钉钉/Slack
4. 团队成员直接接收文件
```

---

## 🚀 快速开始

### 1. 创建第一个节点
```
选择代码 → 右键 → New Node → 查看预览
```

### 2. 建立执行路径
```
选择代码 → 右键 → New Child Node → 建立关系
```

### 3. 追踪位置变化
```
修改代码 → 点击节点 → 点击 OK → 自动更新
```

### 4. 创建分叉
```
选择节点 → 选择代码 → New Parent Node → 自动分叉
```

### 5. 编辑节点
```
点击节点 → Edit Node → 修改信息 → 保存 → 自动验证
```

### 6. 分享图表
```
状态栏 → 导出 CodePath → 选择位置 → 分享文件
```

---

## ⚙️ 配置建议

### 推荐配置
```json
{
  "codepath.defaultView": "text",              // 默认文本视图
  "codepath.autoSave": true,                   // 启用自动保存
  "codepath.autoLoadLastGraph": true,          // 启动时自动加载
  "codepath.previewRefreshInterval": 1000,     // 1秒刷新间隔
  "codepath.maxNodesPerGraph": 100             // 限制100个节点
}
```

### 性能优化
- 每个图表建议不超过 100 个节点
- 大图表使用文本视图（更快）
- 定期清理不需要的图表
- 使用树分叉而不是创建重复节点

---

## 📚 文档资源

- **[完整用户指南](docs/README-ZH.md)** - 详细使用说明
- **[功能特性总结](FEATURES_SUMMARY.md)** - 所有功能详解
- **[变更日志](CHANGELOG.md)** - 版本更新记录
- **[状态栏菜单指南](docs/STATUS_BAR_MENU.md)** - 快捷菜单使用
- **[贡献指南](CONTRIBUTING.md)** - 开发和贡献

---

## 🐛 已知问题

- 某些子节点创建边缘情况可能失败（竞态条件）
- Mermaid 渲染对特殊字符可能过于严格
- 扩展激活顺序需要优化

---

## 🔮 未来计划

### v0.2.0 计划
- [ ] 批量更新节点位置
- [ ] 撤销/重做功能
- [ ] 节点搜索和过滤
- [ ] 图表合并功能
- [ ] 自定义节点颜色
- [ ] 导出为 PNG/SVG

### v0.3.0 计划
- [ ] 协作编辑支持
- [ ] 云端同步
- [ ] 移动端查看
- [ ] AI 辅助路径生成

---

## 💬 反馈和支持

- **问题反馈**: [GitHub Issues](https://github.com/your-org/codepath-extension/issues)
- **功能建议**: [GitHub Discussions](https://github.com/your-org/codepath-extension/discussions)
- **文档**: [Wiki](https://github.com/your-org/codepath-extension/wiki)

---

## 🎉 总结

CodePath v0.1.0 提供了一套完整的代码执行路径追踪解决方案：

✅ **智能追踪** - 自动检测和更新代码位置
✅ **灵活管理** - 多图表、树分叉、节点编辑
✅ **便捷操作** - 状态栏菜单、文件浏览器集成
✅ **团队协作** - 导出/导入、文件分享
✅ **可视化** - 文本和图表双重视图
✅ **跨平台** - Windows/macOS/Linux 全支持

**立即开始**: 选择代码 → 右键 → New Node → 开始追踪！

---

**版本**: v0.1.0
**发布日期**: 2025-10-04
**文档更新**: 2025-10-04
